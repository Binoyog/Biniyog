<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>Biniyog | Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f172a;
  color:#fff;
}
header{
  background:#020617;
  padding:15px;
  text-align:center;
  font-size:20px;
  font-weight:bold;
}
.container{
  padding:15px;
}
.card{
  background:#020617;
  padding:15px;
  border-radius:12px;
  margin-bottom:15px;
  box-shadow:0 0 10px rgba(0,0,0,0.5);
}
.title{
  font-size:14px;
  opacity:0.8;
}
.value{
  font-size:26px;
  font-weight:bold;
  color:#22c55e;
}
.menu{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:12px;
}
.menu a{
  text-decoration:none;
  background:#020617;
  padding:12px;
  border-radius:10px;
  text-align:center;
  font-size:13px;
  color:#fff;
}
.menu a:hover{
  background:#1e293b;
}
.logout{
  background:#ef4444;
  margin-top:15px;
}
</style>
</head>

<body>

<header>
üìä Dashboard
</header>

<div class="container">

<div class="card">
  <div class="title">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</div>
  <div class="value">‡ß≥ <span id="balance">0</span></div>
</div>

<div class="card">
  <div class="title">‡¶Æ‡ßã‡¶ü ‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü</div>
  <div class="value">‡ß≥ <span id="totalInvest">0</span></div>
</div>

<div class="card">
  <div class="title">‡¶Æ‡ßã‡¶ü ‡¶Ü‡ßü</div>
  <div class="value">‡ß≥ <span id="totalEarned">0</span></div>
</div>

<div class="menu">
  <a href="investment.html">üìà Invest</a>
  <a href="my-investments.html">üìÇ My Plans</a>
  <a href="deposit.html">‚ûï Deposit</a>
  <a href="withdraw.html">‚ûñ Withdraw</a>
  <a href="transaction.html">üßæ History</a>
  <a href="refer.html">üë• Refer</a>
  <a href="balance.html">üí∞ Balance</a>
  <a href="index.html" onclick="logout()">üö™ Logout</a>
</div>

</div>

<script>
/* =====================
   LOGIN CHECK
===================== */
const user = localStorage.getItem("loggedInUser");
if(!user){
  location.href="index.html";
}

/* =====================
   AUTO DAILY INCOME ENGINE
===================== */
let investments = JSON.parse(localStorage.getItem("investments")) || [];
let balanceKey = "balance_"+user;
let balance = Number(localStorage.getItem(balanceKey)) || 0;
let now = Date.now();
let changed = false;

investments.forEach(inv=>{
  if(inv.user !== user) return;

  let daysPassed = Math.floor((now - inv.start) / (24*60*60*1000));
  let shouldEarn = Math.min(daysPassed, inv.days) * inv.daily;

  if(inv.earned < shouldEarn){
    let diff = shouldEarn - inv.earned;
    inv.earned = shouldEarn;
    balance += diff;
    changed = true;
  }
});

if(changed){
  localStorage.setItem(balanceKey, balance);
  localStorage.setItem("investments", JSON.stringify(investments));
}

/* =====================
   LOAD DASHBOARD DATA
===================== */
document.getElementById("balance").innerText = balance.toFixed(0);

let totalInvest = 0;
let totalEarned = 0;

investments.forEach(inv=>{
  if(inv.user === user){
    totalInvest += inv.amount;
    totalEarned += inv.earned;
  }
});

document.getElementById("totalInvest").innerText = totalInvest;
document.getElementById("totalEarned").innerText = totalEarned;

/* =====================
   LOGOUT
===================== */
function logout(){
  localStorage.removeItem("loggedInUser");
}
</script>

</body>
</html>
