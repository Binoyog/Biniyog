<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>Biniyog Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background:#0f172a;
      color:#fff;
    }
    header{
      background:#020617;
      padding:15px;
      text-align:center;
      font-size:20px;
      font-weight:bold;
    }
    .container{
      padding:15px;
    }
    .card{
      background:#020617;
      padding:15px;
      border-radius:10px;
      margin-bottom:15px;
      box-shadow:0 0 10px rgba(0,0,0,0.5);
    }
    .balance{
      font-size:26px;
      color:#22c55e;
      font-weight:bold;
    }
    .btn{
      display:block;
      text-align:center;
      padding:12px;
      background:#22c55e;
      color:#000;
      border-radius:8px;
      text-decoration:none;
      margin-top:10px;
      font-weight:bold;
    }
    .btn.secondary{
      background:#38bdf8;
    }
    .btn.danger{
      background:#ef4444;
      color:#fff;
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
    }
    th,td{
      padding:8px;
      border-bottom:1px solid #1e293b;
      text-align:center;
      font-size:14px;
    }
    th{
      color:#38bdf8;
    }
  </style>
</head>
<body>

<header>
  üìä Biniyog Dashboard
</header>

<div class="container">

  <div class="card">
    <div>‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</div>
    <div class="balance">‡ß≥ <span id="balance">0</span></div>
  </div>

  <div class="card">
    <div>‡¶Æ‡ßã‡¶ü ‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü</div>
    <div class="balance">‡ß≥ <span id="totalInvest">0</span></div>
  </div>

  <div class="card">
    <div>‡¶Æ‡ßã‡¶ü ‡¶Ü‡¶Ø‡¶º</div>
    <div class="balance">‡ß≥ <span id="totalEarn">0</span></div>
  </div>

  <a href="deposit.html" class="btn">‚ûï Deposit</a>
  <a href="withdraw.html" class="btn secondary">‚ûñ Withdraw</a>
  <a href="investment.html" class="btn">üìà New Investment</a>
  <a href="my-investments.html" class="btn secondary">üìã My Investments</a>

  <div class="card">
    <h3>üìë Investment Summary</h3>
    <table>
      <thead>
        <tr>
          <th>Amount</th>
          <th>Daily %</th>
          <th>Days</th>
          <th>Earned</th>
        </tr>
      </thead>
      <tbody id="investmentList">
        <tr><td colspan="4">No Investment Found</td></tr>
      </tbody>
    </table>
  </div>

  <a href="#" class="btn danger" onclick="logout()">üö™ Logout</a>

</div>

<script>
/* ===============================
   LOGIN CHECK
================================ */
const user = localStorage.getItem("loggedInUser");
if(!user){
  location.href = "index.html";
}

/* ===============================
   AUTO DAILY INCOME ENGINE
================================ */
(function(){
  let investments = JSON.parse(localStorage.getItem("investments")) || [];
  let balance = Number(localStorage.getItem("balance_"+user)) || 0;
  let now = Date.now();
  let changed = false;

  investments.forEach(inv=>{
    if(inv.user !== user) return;

    let daysPassed = Math.floor((now - inv.start) / (24*60*60*1000));
    if(daysPassed > inv.days) daysPassed = inv.days;

    let shouldEarn = daysPassed * inv.daily;
    let alreadyEarned = inv.earned || 0;

    if(shouldEarn > alreadyEarned){
      let diff = shouldEarn - alreadyEarned;
      balance += diff;
      inv.earned = shouldEarn;
      changed = true;
    }
  });

  if(changed){
    localStorage.setItem("balance_"+user, balance);
    localStorage.setItem("investments", JSON.stringify(investments));
  }
})();

/* ===============================
   LOAD DATA
================================ */
let balance = Number(localStorage.getItem("balance_"+user)) || 0;
document.getElementById("balance").innerText = balance;

let investments = JSON.parse(localStorage.getItem("investments")) || [];
let tbody = document.getElementById("investmentList");

let totalInvest = 0;
let totalEarn = 0;
tbody.innerHTML = "";

investments.forEach(inv=>{
  if(inv.user !== user) return;

  totalInvest += inv.amount;
  totalEarn += (inv.earned || 0);

  let tr = document.createElement("tr");
  tr.innerHTML = `
    <td>‡ß≥${inv.amount}</td>
    <td>${inv.percent}%</td>
    <td>${inv.days}</td>
    <td>‡ß≥${inv.earned || 0}</td>
  `;
  tbody.appendChild(tr);
});

if(tbody.innerHTML === ""){
  tbody.innerHTML = `<tr><td colspan="4">No Investment Found</td></tr>`;
}

document.getElementById("totalInvest").innerText = totalInvest;
document.getElementById("totalEarn").innerText = totalEarn;

/* ===============================
   LOGOUT
================================ */
function logout(){
  localStorage.removeItem("loggedInUser");
  location.href = "index.html";
}
</script>

</body>
</html>
