<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>Biniyog | User Dashboard View</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#f4f6f9;
}
.header{
  background:#1e272e;
  color:#fff;
  padding:15px;
  text-align:center;
  font-size:18px;
}
.container{
  padding:15px;
}
.card{
  background:#fff;
  border-radius:8px;
  padding:15px;
  margin-bottom:12px;
  box-shadow:0 2px 5px rgba(0,0,0,.1);
}
.card h3{
  margin:0 0 8px;
  font-size:16px;
  color:#333;
}
.value{
  font-size:15px;
  color:#555;
}
.error{
  color:red;
  text-align:center;
  margin-top:30px;
}
.loading{
  text-align:center;
  margin-top:30px;
}
.back{
  display:block;
  text-align:center;
  margin-top:20px;
  text-decoration:none;
  color:#1e90ff;
}
</style>
</head>

<body>

<div class="header">ðŸ‘¤ User Dashboard View</div>

<div class="container" id="content">
  <div class="loading">Loading user data...</div>
</div>

<a class="back" href="admin-dashboard.html">â¬… Back to Admin Dashboard</a>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
/* ðŸ”¥ Firebase Config */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.firestore();

/* ðŸ”‘ get uid from URL */
const params = new URLSearchParams(window.location.search);
const userUid = params.get("uid");

const content = document.getElementById("content");

if(!userUid){
  content.innerHTML = "<div class='error'>User UID missing</div>";
}

/* ðŸ” Auth check */
auth.onAuthStateChanged(async(user)=>{
  if(!user){
    window.location.href = "login.html";
    return;
  }

  const adminSnap = await db.collection("users").doc(user.uid).get();
  if(!adminSnap.exists || adminSnap.data().role !== "admin"){
    content.innerHTML = "<div class='error'>Access Denied (Admin only)</div>";
    return;
  }

  loadUser();
});

/* ðŸ“¥ Load user data */
async function loadUser(){
  try{
    const snap = await db.collection("users").doc(userUid).get();

    if(!snap.exists){
      content.innerHTML = "<div class='error'>User not found</div>";
      return;
    }

    const u = snap.data();

    content.innerHTML = `
      <div class="card">
        <h3>ðŸ‘¤ Name</h3>
        <div class="value">${u.name || "N/A"}</div>
      </div>

      <div class="card">
        <h3>ðŸ“ž Phone</h3>
        <div class="value">${u.phone || "N/A"}</div>
      </div>

      <div class="card">
        <h3>ðŸ’° Balance</h3>
        <div class="value">${u.balance || 0} à§³</div>
      </div>

      <div class="card">
        <h3>ðŸ“¦ Current Plan</h3>
        <div class="value">${u.currentPlan || "No Active Plan"}</div>
      </div>

      <div class="card">
        <h3>ðŸ†” UID</h3>
        <div class="value">${userUid}</div>
      </div>
    `;
  }catch(e){
    content.innerHTML = "<div class='error'>Error loading data</div>";
  }
}
</script>

</body>
</html>
