<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>Biniyog | Deposit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    body{
      margin:0;
      font-family:'Hind Siliguri', sans-serif;
      background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .box{
      width:100%;
      max-width:420px;
      background:#fff;
      border-radius:14px;
      padding:25px;
      box-shadow:0 20px 45px rgba(0,0,0,.35);
    }
    h2{
      text-align:center;
      margin-bottom:15px;
      color:#203a43;
    }
    .info{
      background:#f1f5f9;
      padding:12px;
      border-radius:10px;
      font-size:14px;
      margin-bottom:18px;
      line-height:1.6;
    }
    label{
      display:block;
      margin-top:14px;
      font-weight:500;
    }
    input,select{
      width:100%;
      padding:12px;
      margin-top:6px;
      border-radius:10px;
      border:1px solid #cbd5e1;
      font-size:15px;
    }
    button{
      width:100%;
      margin-top:22px;
      padding:14px;
      border:none;
      border-radius:12px;
      background:linear-gradient(135deg,#11998e,#38ef7d);
      color:#fff;
      font-size:16px;
      font-weight:600;
    }
    button:disabled{
      opacity:.6;
    }
    .note{
      margin-top:14px;
      text-align:center;
      font-size:13px;
      color:#475569;
    }
  </style>
</head>
<body>

<div class="box">
  <h2>‡¶°‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</h2>

  <div class="info">
    <b>Send Money / Cash In</b><br>
    ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞: <b>01748786117</b><br>
    Minimum Deposit: <b>500‡ß≥</b>
  </div>

  <form id="depositForm">
    <label>Payment Method</label>
    <select id="method" required>
      <option value="">‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</option>
      <option value="Bkash">Bkash</option>
      <option value="Nagad">Nagad</option>
      <option value="Rocket">Rocket</option>
    </select>

    <label>Amount (‡ß≥)</label>
    <input type="number" id="amount" min="500" required>

    <label>Transaction ID</label>
    <input type="text" id="trxId" required>

    <button id="submitBtn">‡¶°‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
  </form>

  <div class="note">
    ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶ï‡¶∞‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶¨‡ßá
  </div>
</div>

<!-- üî• Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBFsTzlRPoWHVXEHbKrPdwxslxZGa7Kqfw",
    authDomain: "biniyog-95d00.firebaseapp.com",
    projectId: "biniyog-95d00",
    storageBucket: "biniyog-95d00.firebasestorage.app",
    messagingSenderId: "523238228802",
    appId: "1:523238228802:web:a65183bdc4c268f94efedb"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  let currentUser = null;

  onAuthStateChanged(auth, user => {
    if(!user){
      location.href = "index.html";
    }else{
      currentUser = user;
    }
  });

  document.getElementById("depositForm").addEventListener("submit", async e => {
    e.preventDefault();

    if(!currentUser) return;

    const method = document.getElementById("method").value;
    const amount = Number(document.getElementById("amount").value);
    const trxId = document.getElementById("trxId").value.trim();
    const btn = document.getElementById("submitBtn");

    if(!method || amount < 500 || !trxId) return;

    btn.disabled = true;
    btn.innerText = "Processing...";

    await addDoc(collection(db,"transactions"),{
      uid: currentUser.uid,
      phone: currentUser.phoneNumber || "",
      type: "deposit",
      method,
      amount,
      trxId,
      status: "pending",
      createdAt: serverTimestamp()
    });

    // ‚úÖ ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶π‡ßã‡¶Æ / ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°
    window.location.href = "dashboard.html";
  });
</script>

</body>
</html>
